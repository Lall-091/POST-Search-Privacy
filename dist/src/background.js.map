{"version":3,"sources":["background.js"],"names":["url_to_queries","_url","qd","search","substr","split","forEach","item","k","v","decodeURIComponent","push","chrome","webRequest","onBeforeRequest","addListener","details","tabs","update","tabId","url","runtime","getURL","qel","URL","searchParams","has","qval","getAll","onUpdated","handler","changeInfo","status","removeListener","sendMessage","data","cancel","urls"],"mappings":";AAaA,IAAA,EAAA,EAAA,SAAA,EAAA,EAAA,GAAA,OAAA,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IAAA,IAAA,SAAA,IAAA,MAAA,IAAA,UAAA,6IAAA,SAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,GAAA,iBAAA,EAAA,OAAA,EAAA,EAAA,GAAA,IAAA,EAAA,OAAA,UAAA,SAAA,KAAA,GAAA,MAAA,GAAA,GAAA,MAAA,WAAA,GAAA,EAAA,cAAA,EAAA,EAAA,YAAA,MAAA,QAAA,GAAA,QAAA,EAAA,MAAA,KAAA,GAAA,cAAA,GAAA,2CAAA,KAAA,GAAA,EAAA,EAAA,QAAA,GAAA,SAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,UAAA,EAAA,EAAA,QAAA,IAAA,IAAA,EAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,OAAA,EAAA,SAAA,EAAA,EAAA,GAAA,GAAA,oBAAA,QAAA,OAAA,YAAA,OAAA,GAAA,CAAA,IAAA,EAAA,GAAA,GAAA,EAAA,GAAA,EAAA,OAAA,EAAA,IAAA,IAAA,IAAA,EAAA,EAAA,EAAA,OAAA,cAAA,GAAA,EAAA,EAAA,QAAA,QAAA,EAAA,KAAA,EAAA,QAAA,GAAA,EAAA,SAAA,GAAA,GAAA,IAAA,MAAA,GAAA,GAAA,EAAA,EAAA,EAAA,QAAA,IAAA,GAAA,MAAA,EAAA,QAAA,EAAA,SAAA,QAAA,GAAA,EAAA,MAAA,GAAA,OAAA,GAAA,SAAA,EAAA,GAAA,GAAA,MAAA,QAAA,GAAA,OAAA,EAAA,SAAA,EAAA,EAAA,GAAA,OAAA,IAAA,EAAA,EAAA,MAAA,IAAA,OAAA,OAAA,OAAA,iBAAA,EAAA,CAAA,IAAA,CAAA,MAAA,OAAA,OAAA,OAXA,SAASA,EAAeC,GACnBC,IAAAA,EAAK,GACLD,GAAAA,EAAKE,OACR,OAAOF,EAAKE,OAAOC,OAAO,GAAGC,MAASC,IAAAA,EAAAA,EAAAA,CAAAA,QAAAA,QAAQ,SAACC,GACjCA,IAD0C,EAAA,EAC1CA,EAAKF,MADqC,IAAA,EAAA,EAAA,CAAA,QAAA,GAClDG,EADkD,EAAA,GAC/CC,EAD+C,EAAA,GAEvDA,EAAIA,GAAKC,mBAAmBD,EAAnBC,CACRR,EAAGM,GAAKN,EAAGM,IAAM,IAAIG,KAAKF,KAK9BG,OAAOC,WAAWC,gBAAgBC,YACjC,SAAUC,GACTJ,OAAOK,KAAKC,OAAOF,EAAQG,MAAO,CACjCC,IAAKR,OAAOS,QAAQC,OAAO,qBAGxBF,IAEAG,EAFAH,EAAM,IAAII,IAAIR,EAAQI,KAGtBA,EAAIK,aAAaC,IAAI,OACxBH,EAAM,KACHH,EAAIK,aAAaC,IAAI,WACxBH,EAAM,SACHI,IAAAA,EAAOP,EAAIK,aAAaG,OAAOL,GAiB5B,OANPX,OAAOK,KAAKY,UAAUd,YAVR,SAAVe,EAAoBX,EAAOY,GAC1BZ,IAAUH,EAAQG,OAA+B,aAAtBY,EAAWC,SACzCpB,OAAOK,KAAKY,UAAUI,eAAeH,GACrClB,OAAOK,KAAKiB,YAAYf,EAAO,CAC9BgB,KAAMR,EACNJ,IAAKA,EACLH,IAAKA,OAKRR,OAAOK,KAAKiB,YAAYlB,EAAQG,MAAO,CACtCgB,KAAMR,EACNJ,IAAKA,EACLH,IAAKA,IAEC,CAAEgB,QAAQ,IAElB,CACCC,KAAM,CACL,+BACA,qCACA,8BACA,oCACA,8CACA,0CACA,+CACA,6CAGF,CAAC","file":"background.js","sourceRoot":"../../src","sourcesContent":["\n\nfunction url_to_queries(_url) {\n\tvar qd = {};\n\tif (_url.search)\n\t\treturn _url.search.substr(1).split`&`.forEach((item) => {\n\t\t\tlet [k, v] = item.split`=`\n\t\t\tv = v && decodeURIComponent(v)\n\t\t\t(qd[k] = qd[k] || []).push(v)\n\t\t})\n}\n\n\nchrome.webRequest.onBeforeRequest.addListener(\n\tfunction (details) {\n\t\tchrome.tabs.update(details.tabId, {\n\t\t\turl: chrome.runtime.getURL(\"src/search.html\"),\n\t\t})\n\t\t\n\t\tvar url = new URL(details.url)\n\t\t//let data = url_to_queries()\n\t\tlet qel\n\t\tif (url.searchParams.has('q'))\n\t\t\tqel = 'q'\n\t\tif (url.searchParams.has('query'))\n\t\t\tqel = 'query'\n\t\tlet qval = url.searchParams.getAll(qel)\n\t\tlet handler = function (tabId, changeInfo) {\n\t\t\tif (tabId === details.tabId && changeInfo.status === \"complete\") {\n\t\t\t\tchrome.tabs.onUpdated.removeListener(handler)\n\t\t\t\tchrome.tabs.sendMessage(tabId, {\n\t\t\t\t\tdata: qval,\n\t\t\t\t\tqel: qel,\n\t\t\t\t\turl: url\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tchrome.tabs.onUpdated.addListener(handler)\n\t\tchrome.tabs.sendMessage(details.tabId, {\n\t\t\tdata: qval,\n\t\t\tqel: qel,\n\t\t\turl: url\n\t\t})\n\t\treturn { cancel: true }\n\t},\n\t{\n\t\turls: [\n\t\t\t\"https://duckduckgo.com/?*q=*\",\n\t\t\t\"https://start.duckduckgo.com/?*q=*\",\n\t\t\t\"http://duckduckgo.com/?*q=*\",\n\t\t\t\"http://start.duckduckgo.com/?*q=*\",\n\t\t\t\"http://www.startpage.com/sp/search?*query=*\",\n\t\t\t\"http://startpage.com/sp/search?*query=*\",\n\t\t\t\"https://www.startpage.com/sp/search?*query=*\",\n\t\t\t\"https://startpage.com/sp/search?*query=*\"\n\t\t],\n\t},\n\t[\"blocking\"]\n)\n"]}